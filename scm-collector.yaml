frequency:
  cron: '*/15 * * * *'
filter:
  kind: Component
cache:
  duration:
    minutes: 30
collects:
  # Extracts if files exist at the given paths.
  - factName: has_license.url
    type: exists
    data:
        - name: exists
          path: LICENSE

  # Extracts if files exist at the given paths.
  - factName: has_readme.url
    type: exists
    data:
        - name: exists
          path: README.md

  # Extracts two data elements, ubi and date, from the file at the specified path
  # using the given regex. Each capture group corresponds to the data elements, in order.
  - factName: github.docker.url
    type: regex
    path: /pom.xml
    regex: gcr.io/spotify-base-images/(.*):(.*)@.*
    data:
      - name: ubi
        type: string
      - name: date
        type: string

  # Extracts json data from the file at the given path.
  # Here:
  # metadata.tags will be extracted into an array named 'tags' of type String, and
  # metadata.labels.service_type will be extracted into a variable called service_type of type string
  - factName: entity.metadata.url
    type: json
    path: /system-info.yaml
    data:
      - name: tags
        jsonPath: metadata.tags
        type: array
        items:
          type: string
      - name: service_type
        jsonPath: metadata.labels.service_type
        type: string

  # # Extracts json data from the file at the given path.
  # # Here:
  # # metadata.tags will be extracted into an array named 'tags' of type String, and
  # # metadata.labels.service_type will be extracted into a variable called service_type of type string
  - factName: check-ids-fact
    type: json
    path: /checkers.yaml
    data:
      - name: ids
        jsonPath: id
        type: array
        items:
          type: string
